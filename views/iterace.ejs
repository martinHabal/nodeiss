<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <style>
    /* Styly pro rozvrh */
    table {
      border-collapse: collapse;
      width: 100%;
    }

    th,
    td {
      border: 1px solid black;
      padding: 8px;
      text-align: center;
      cursor: pointer;
    }

    th {
      background-color: #f2f2f2;
    }
  </style>
  
</head>

<body>
  <button><a href="/">home</a></button>

  <script>
    // Získání aktuálního data
    const currentDate = new Date();

    // Získání roku, měsíce a dne
    const currentYear = currentDate.getFullYear();
    const currentMonth = currentDate.getMonth() + 1; // Měsíce jsou indexovány od 0 (leden) do 11 (prosinec)
    const currentDay = currentDate.getDate();

    // Zobrazení aktuálního roku, měsíce a dne
    console.log(`Aktuální rok: ${currentYear}`);
    console.log(`Aktuální měsíc: ${currentMonth}`);
    console.log(`Aktuální den: ${currentDay}`);

    // Získání prvního dne měsíce následujícího měsíce
    const firstDayOfNextMonth = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 1);

    // Posun na poslední den aktuálního měsíce
    firstDayOfNextMonth.setDate(firstDayOfNextMonth.getDate() - 1);

    // Získání počtu dní v aktuálním měsíci
    const numberOfDaysInMonth = firstDayOfNextMonth.getDate();
  </script>
  <h3>
    <% const currentDate=new Date(); %>
    <% const currentYear=currentDate.getFullYear(); %>
    <% const currentMonth=currentDate.getMonth() + 1; %>
    <% const currentDay=currentDate.getDate(); %>

    <% const firstDayOfNextMonth=new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 1);
                            %>
    <% firstDayOfNextMonth.setDate(firstDayOfNextMonth.getDate() - 1); %>
    <% const numberOfDaysInMonth=firstDayOfNextMonth.getDate(); %>

    <% const daysOfWeek=['Neděle', 'Pondělí' , 'Úterý' , 'Středa' , 'Čtvrtek' , 'Pátek'
                                        , 'Sobota' ]; %>
    <% const dayOfWeekNumber=currentDate.getDay();%>
    <% const dayOfWeekName=daysOfWeek[dayOfWeekNumber];%>

    <%= currentDay + ". " + currentMonth + ". " + currentYear
                                                    + " a tento měsíc má " + numberOfDaysInMonth + " dní" + " dnes je "
                                                    + dayOfWeekName %>
  </h3>

  
  <h1>
    iterace
  </h1>
  <% day="Pondělí" %>
  <% hour=0 %>
  <% date=1 %>
  <table>
    <tr>
      <th></th>
      <th></th>
      <th>0(07:00 - 07:45)</th>
      <th>1(08:00 - 08:45)</th>
      <th>2(08:55 - 09:40)</th>
      <th>3(09:50 - 10:35)</th>
      <th>4(10:55 - 11:40)</th>
      <th>5(11:50 - 12:35)</th>
      <th>6(12:45 - 13:30)</th>
      <th>7(13:40 - 14:25)</th>
      <th>8(14:30 - 15:15)</th>
      <th>9(15:20 - 16:05)</th>
      <th>10(16:10 - 18:00)</th>

    </tr>

    <tr>

      <td>
        <%=date%>
        <% date++ %>
      </td>
      <td>
        <%=day%>
      </td>
      <% results.forEach((item, index)=> {%>

      <% if(index===11) {%>
      <%day="Úterý" %>
    </tr>
    <tr>
      <td>
        <%=date%>
        <% date++ %>
      </td>
      <td>
        <%=day%>
      </td>
      <%} else if(index===22) {%>
      <%day="Středa" %>
    </tr>
    <tr>
      <td>
        <%=date%>
        <% date++ %>
      </td>
      <td>
        <%=day%>
      </td>
      <%} else if(index===33) {%>
      <%day="Čtvrtek" %>
    </tr>
    <tr>
      <td>
        <%=date%>
        <% date++ %>
      </td>
      <td>
        <%=day%>
      </td>
      <%}else if(index===44) {%>
      <%day="Pátek" %>
    </tr>
    <tr>
      <td>
        <%=date%>
        <% date++ %>
      </td>
      <td>
        <%=day%>
      </td>
      <%}else if(index===55) {%>
      <%day="Sobota" %>
    </tr>
    <tr>
      <td>
        <%=date%>
        <% date++ %>
      </td>
      <td>
        <%=day%>
      </td>
      <%day="Neděle" %>
    </tr>
    <tr>
      <td>
        <%=date%>
        <% date++ %>
      </td>
      <td>
        <%=day%>
      </td>
    </tr>
    <tr>
      <%day="Pondělí" %>
      <td>
        <%=date%>
        <% date++ %>
      </td>
      <td>
        <%=day%>
      </td>
      <%}else if(index===66) {%>
      <%day="Úterý" %>
    </tr>
    <tr>
      <td>
        <%=date%>
        <% date++ %>
      </td>
      <td>
        <%=day%>
      </td>
      <%}else if(index===77) {%>
      <%day="Středa" %>
    </tr>
    <tr>
      <td>
        <%=date%>
        <% date++ %>
      </td>
      <td>
        <%=day%>
      </td>
      <%}else if(index===88) {%>
      <%day="Čtvrtek" %>
    </tr>
    <tr>
      <td>
        <%=date%>
        <% date++ %>
      </td>
      <td>
        <%=day%>
      </td>
      <%}else if(index===99) {%>
      <%day="Pátek" %>
    </tr>
    <tr>
      <td>
        <%=date%>
        <% date++ %>
      </td>
      <td>
        <%=day%>
      </td>
      <%} else if(index===110) {%>
      <%day="Sobota" %>
    </tr>
    <tr>
      <td>
        <%=date%>
        <% date++ %>
      </td>
      <td>
        <%=day%>
      </td>
      <%day="Neděle" %>
    </tr>
    <tr>
      <td>
        <%=date%>
        <% date++ %>
      </td>
      <td>
        <%=day%>
      </td>
    </tr>
    <tr>
      <%day="Pondělí" %>
      <td>
        <%=date%>
        <% date++ %>
      </td>
      <td>
        <%=day%>
      </td>

      <%}else if(index===121) {%>
      <%day="Úterý" %>
    </tr>
    <tr>
      <td>
        <%=date%>
        <% date++ %>
      </td>
      <td>
        <%=day%>
      </td>%>
      <%}else if(index===132) {%>
      <%day="Středa" %>
    </tr>
    <tr>
      <td>
        <%=date%>
        <% date++ %>
      </td>
      <td>
        <%=day%>
      </td>%>
      <%}else if(index===143) {%>
      <%day="Čtvrtek" %>
    </tr>
    <tr>
      <td>
        <%=date%>
        <% date++ %>
      </td>
      <td>
        <%=day%>
      </td>
      <%} else if(index===154) {%>
      <%day="Pátek" %>
    </tr>
    <tr>
      <td>
        <%=date%>
        <% date++ %>
      </td>
      <td>
        <%=day%>
      </td>
      <%}else if(index===165) {%>
      <%day="Sobota" %>
    </tr>
    <tr>
      <td>
        <%=date%>
        <% date++ %>
      </td>
      <td>
        <%=day%>
      </td>
      <%day="Neděle" %>
    </tr>
    <tr>
      <td>
        <%=date%>
        <% date++ %>
      </td>
      <td>
        <%=day%>
      </td>
    </tr>
    <tr>
      <td>
        <%=date%>
        <% date++ %>
      </td>
      <%day="Pondělí" %>
      <td>
        <%=day%>
      </td>
      <%}else if(index===176) {%>
      <%day="Úterý" %>
    </tr>
    <tr>
      <td>
        <%=date%>
        <% date++ %>
      </td>
      <td>
        <%=day%>
      </td>
      <%} else if(index===187) {%>
      <%day="Středa" %>
    </tr>
    <tr>
      <td>
        <%=date%>
        <% date++ %>
      </td>
      <td>
        <%=day%>
      </td>%>
      <%}else if(index===198) {%>
      <%day="Čtvrtek" %>
    </tr>
    <tr>
      <td>
        <%=date%>
        <% date++ %>
      </td>
      <td>
        <%=day%>
      </td>%>
      <%}else if(index===209) {%>
      <%day="Pátek" %>
    </tr>
    <tr>
      <td>
        <%=date%>
        <% date++ %>
      </td>
      <td>
        <%=day%>
      </td>%>
      <%}else if(index===220) {%>
      <%day="Sobota" %>
    </tr>
    



    <tr>
      <td>
        <%=date%>
        <% date++ %>
      </td>
      <td>
        <%=day%>
      </td>
      <%day="Neděle" %>
    </tr>
    <tr>
      <td>
        <%=date%>
        <% date++ %>
      </td>
      <td>
        <%=day%>
      </td>
    </tr>
    <tr>
      <td>
        <%=date%>
        <% date++ %>
      </td>
      <%day="Pondělí22" %>

      <td>
        <%=day%>
      </td>
      <%}else if(index===231) {%>
      <%day="Úterý" %>
    </tr>
    <tr>
      <td>
        <%=date%>
        <% date++ %>
      </td>
      <td>
        <%=day%>
      </td>
      <%} else if(index===242) {%>
      <%day="Středa" %>
    </tr>
    <tr>
      <td>
        <%=date%>
        <% date++ %>
      </td>
      <td>
        <%=day%>
      </td>%>
      <%}else if(index===253) {%>
      <%day="Čtvrtek" %>
    </tr>
    <tr>
      <td>
        <%=date%>
        <% date++ %>
      </td>
      <td>
        <%=day%>
      </td>%>
      <%}else if(index===264) {%>
      <%day="Pátek" %>
    </tr>
    <tr>
      <td>
        <%=date%>
        <% date++ %>
      </td>
      <td>
        <%=day%>
      </td>%>
      <%}else if(index===275) {%>
      <%day="Sobota" %>
    </tr>

    <tr>
      <td>
        <%=date%>
        <% date++ %>
      </td>
      <td>
        <%=day%>
      </td>
      <%day="Neděle" %>
    </tr>
    <tr>
      <td>
        <%=date%>
        <% date++ %>
      </td>
      <td>
        <%=day%>
      </td>
    </tr>
    <tr>

      <%}else if(index > 205) {%>


      <%}%>
      <td id="<%= item.id %>" day="<%= item.day %>" hour="<%= item.hour %>" onclick=change(event)>
                                        <%=item.class%>
      </td>

      <%})%>
    </tr>
  </table>
  <script>
    function change() {
      console.log(event.target)

      let data = prompt("Zadejte předmět")

      // URL API, kam bude odeslán požadavek
      const apiUrl = '/iteraceupdate';

      // Data, která budou odeslána jako součást požadavku (může být objekt nebo FormData)
      const requestData = {
        id: event.target.id,
        data: data
      };

      // Konfigurace pro POST požadavek
      const requestOptions = {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json' // Změňte na 'application/x-www-form-urlencoded', pokud odesíláte FormData
        },
        body: JSON.stringify(requestData) // Změňte na new URLSearchParams(requestData) pro 'application/x-www-form-urlencoded'
      };

      // Odeslání požadavku pomocí funkce fetch
      fetch(apiUrl, requestOptions)
        .then(response => {
          if (!response.ok) {
            throw new Error('Chyba při komunikaci s API.');
          }
          return response.json();
        })
        .then(data => {
          console.log('Úspěšně zpracována odpověď z API:', data);
          // Zde můžete provést další zpracování dat z API
        })
        .catch(error => {
          console.error('Chyba:', error);
          // Zde můžete zpracovat chybu a poskytnout zpětnou vazbu uživateli
        });
        location.reload()
    }
    
  </script>
</body>

</html>
<!-- chybi mi na konci break, kdyz by bylo vic dat, ale tech vic stejne nemuze byt ale je to osetreni, a ten kod samozrejme musim zkratit -->